!function(t){function e(e){for(var a,l,o=e[0],s=e[1],c=e[2],u=0,p=[];u<o.length;u++)l=o[u],Object.prototype.hasOwnProperty.call(r,l)&&r[l]&&p.push(r[l][0]),r[l]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a]);for(d&&d(e);p.length;)p.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,o=1;o<n.length;o++){var s=n[o];0!==r[s]&&(a=!1)}a&&(i.splice(e--,1),t=l(l.s=n[0]))}return t}var a={},r={0:0},i=[];function l(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=t,l.c=a,l.d=function(t,e,n){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},l.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)l.d(n,a,function(e){return t[e]}.bind(null,a));return n},l.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="";var o=window.webpackJsonp=window.webpackJsonp||[],s=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=s;i.push([150,1]),n()}({144:function(t,e,n){},145:function(t,e,n){var a=n(55);t.exports=function(t){var e,n="",r=t||{};return function(t,r){r?n+="<span>Loading...</span>":function(){var r=t;if("number"==typeof r.length)for(var i=0,l=r.length;i<l;i++){var o=r[i];n=n+'\n<div class="card p-3 mb-3">\n  <div class="row">\n    <div class="col-3"><img class="img-fluid"'+a.attr("src",o.image,!0,!0)+' style="width:100px; height:100px;"></div>\n    <div class="col-5">\n      <h2 class="h6 strong">'+a.escape(null==(e=o.title)?"":e)+'</h2><strong class="h3 text-primary strong">'+a.escape(null==(e=o.price)?"":e)+' рублей</strong>\n      <div class="text-muted small mt-2">'+a.escape(null==(e=o.descr)?"":e)+'</div>\n    </div>\n    <div class="col-4">\n      <button'+a.attr("class",a.classes(["btn","btn-add-cart",`${o.available?"":"btn-disabled"} ${o.amt?"btn-primary":"btn-outline-primary"}`],[!1,!1,!0]),!1,!0)+' type="button"'+a.attr("disabled",!o.available,!0,!0)+a.attr("id",o.id,!0,!0)+a.attr("data-title",o.title,!0,!0)+a.attr("data-image",o.image,!0,!0)+a.attr("data-price",o.price,!0,!0)+">Добавить в корзину</button>",o.amt&&(n=n+'\n      <div class="mt-2"><span class="strong">Добавлено:&nbsp;</span><span class="text-primary">'+a.escape(null==(e=o.amt)?"":e)+" товаров</span></div>"),o.available||(n+='\n      <div class="mt-2">Нет в наличии</div>'),n+="\n    </div>\n  </div>\n</div>"}else{l=0;for(var i in r){l++;o=r[i];n=n+'\n<div class="card p-3 mb-3">\n  <div class="row">\n    <div class="col-3"><img class="img-fluid"'+a.attr("src",o.image,!0,!0)+' style="width:100px; height:100px;"></div>\n    <div class="col-5">\n      <h2 class="h6 strong">'+a.escape(null==(e=o.title)?"":e)+'</h2><strong class="h3 text-primary strong">'+a.escape(null==(e=o.price)?"":e)+' рублей</strong>\n      <div class="text-muted small mt-2">'+a.escape(null==(e=o.descr)?"":e)+'</div>\n    </div>\n    <div class="col-4">\n      <button'+a.attr("class",a.classes(["btn","btn-add-cart",`${o.available?"":"btn-disabled"} ${o.amt?"btn-primary":"btn-outline-primary"}`],[!1,!1,!0]),!1,!0)+' type="button"'+a.attr("disabled",!o.available,!0,!0)+a.attr("id",o.id,!0,!0)+a.attr("data-title",o.title,!0,!0)+a.attr("data-image",o.image,!0,!0)+a.attr("data-price",o.price,!0,!0)+">Добавить в корзину</button>",o.amt&&(n=n+'\n      <div class="mt-2"><span class="strong">Добавлено:&nbsp;</span><span class="text-primary">'+a.escape(null==(e=o.amt)?"":e)+" товаров</span></div>"),o.available||(n+='\n      <div class="mt-2">Нет в наличии</div>'),n+="\n    </div>\n  </div>\n</div>"}}}.call(this)}.call(this,"goods"in r?r.goods:"undefined"!=typeof goods?goods:void 0,"loading"in r?r.loading:"undefined"!=typeof loading?loading:void 0),n}},146:function(t,e){},147:function(t,e,n){var a=n(55);t.exports=function(t){var e,n="",r=t||{};return function(t,r){r?n+="<span>Loading...</span>":(n+='\n<div class="card p-3">',t.cartList.length?(function(){var r=t.cartList;if("number"==typeof r.length)for(var i=0,l=r.length;i<l;i++){var o=r[i];n=n+'\n  <div class="row bg-light mb-2">\n    <div class="col-3"><img class="img-fluid"'+a.attr("src",o.image,!0,!0)+' alt="Card image cap"></div>\n    <div class="col-5"><strong>'+a.escape(null==(e=o.title)?"":e)+'</strong></div>\n    <div class="col-2 flex align-self-center">'+a.escape(null==(e=o.amt)?"":e)+'х</div>\n    <div class="col-2 flex align-self-center"><span class="fas fa-times remove-from-cart"'+a.attr("id",o.id,!0,!0)+"></span></div>\n  </div>"}else{l=0;for(var i in r){l++;o=r[i];n=n+'\n  <div class="row bg-light mb-2">\n    <div class="col-3"><img class="img-fluid"'+a.attr("src",o.image,!0,!0)+' alt="Card image cap"></div>\n    <div class="col-5"><strong>'+a.escape(null==(e=o.title)?"":e)+'</strong></div>\n    <div class="col-2 flex align-self-center">'+a.escape(null==(e=o.amt)?"":e)+'х</div>\n    <div class="col-2 flex align-self-center"><span class="fas fa-times remove-from-cart"'+a.attr("id",o.id,!0,!0)+"></span></div>\n  </div>"}}}.call(this),n=n+'\n  <div class="row mt-2">\n    <div class="col-12 d-flex flex-column align-items-center"><strong>ИТОГ</strong><strong class="h3 text-primary strong">'+a.escape(null==(e=t.totalPrice)?"":e)+' рублей</strong>\n      <button class="btn btn-primary" type="button">Заказать</button>\n    </div>\n  </div>'):n+="<span>Корзина пуста</span>",n+="\n</div>")}.call(this,"cart"in r?r.cart:"undefined"!=typeof cart?cart:void 0,"loading"in r?r.loading:"undefined"!=typeof loading?loading:void 0),n}},148:function(t,e,n){var a=n(55);t.exports=function(t){var e,n="",r=t||{};return function(t,r,i){n=n+'\n<nav class="mt-3" aria-label="Page navigation">\n  <ul class="pagination">\n    <li'+a.attr("class",a.classes(["page-item",1===t?"disabled":""],[!1,!0]),!1,!0)+'><span class="page-link pagination-item"'+a.attr("data-page",t-1,!0,!0)+' aria-label="Previous"><span aria-hidden="true" style="pointer-events: none;">&laquo;</span><span class="sr-only">Previous</span></span></li>',function(){var i=r;if("number"==typeof i.length)for(var l=0,o=i.length;l<o;l++){"..."===(s=i[l]).index?n+='<span style="width:35px;text-align:center;">...</span>':n=n+"\n    <li"+a.attr("class",a.classes(["page-item",s.index===t?"disabled":""],[!1,!0]),!1,!0)+'><span class="page-link pagination-item"'+a.attr("data-page",s.index,!0,!0)+">"+a.escape(null==(e=s.index)?"":e)+"</span></li>"}else{o=0;for(var l in i){var s;o++,"..."===(s=i[l]).index?n+='<span style="width:35px;text-align:center;">...</span>':n=n+"\n    <li"+a.attr("class",a.classes(["page-item",s.index===t?"disabled":""],[!1,!0]),!1,!0)+'><span class="page-link pagination-item"'+a.attr("data-page",s.index,!0,!0)+">"+a.escape(null==(e=s.index)?"":e)+"</span></li>"}}}.call(this),n=n+"\n    <li"+a.attr("class",a.classes(["page-item",i===t?"disabled":""],[!1,!0]),!1,!0)+'><span class="page-link pagination-item"'+a.attr("data-page",t+1,!0,!0)+' aria-label="Next"><span aria-hidden="true" style="pointer-events: none;">&raquo;</span><span class="sr-only">Next</span></span></li>\n  </ul>\n</nav>'}.call(this,"current"in r?r.current:"undefined"!=typeof current?current:void 0,"pages"in r?r.pages:"undefined"!=typeof pages?pages:void 0,"totalPages"in r?r.totalPages:"undefined"!=typeof totalPages?totalPages:void 0),n}},150:function(t,e,n){"use strict";n.r(e),n.d(e,"addCart",(function(){return g}));n(93),n(99),n(100),n(101),n(102),n(103),n(70),n(104),n(77),n(109),n(110),n(112),n(113),n(114),n(115),n(119),n(122),n(124),n(126),n(134),n(87),n(136),n(137),n(138),n(90),n(143),n(144);var a=n(3),r=n(145),i=function(t){var e=t.data,n=t.loading;if(n)console.log("pending",n),document.querySelector(".list").innerHTML=r({loading:n});else{document.querySelector(".list").innerHTML=r({goods:e,loading:!1});var a=document.querySelectorAll(".btn-add-cart"),i=function(t){g({id:t.target.id,title:t.target.getAttribute("data-title"),image:t.target.getAttribute("data-image"),price:t.target.getAttribute("data-price")})};a.forEach((function(t){t.addEventListener("click",i)}))}};function l(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var s=n(147),c=n(148),d=Object(a.a)({handler:function(t){var e=t.url;return fetch(void 0===e?"http://localhost:3000/goods?_page=1&_limit=15":e).then((function(t){return t.json()}))}}),u=Object(a.a)({handler:function(t){return JSON.parse(localStorage.getItem("cart"))}}),p=Object(a.a)({handler:function(t){localStorage.setItem("cart",JSON.stringify(t,null,2))}}),g=Object(a.b)("addCart"),f=Object(a.b)("removeCart"),v=Object(a.b)("sumPrice"),m=Object(a.b)("copyFromLocalStorage"),b=Object(a.b)("addCartData"),h=Object(a.b)("removeCartData"),y=Object(a.b)("changePage"),x=Object(a.c)([]).on(b,(function(t,e){return t.map((function(t){var n=e.find((function(e){return e.id===t.id}));return Object.assign({},t,n)}))})).on(h,(function(t,e){t.find((function(t){return t.id===e}));return t.map((function(t){var n=Object.assign({},t);return delete n.amt,t.id===e?n:t}))})).on(d.done,(function(t,e){var n=e.result;if(n)return n.map((function(t){var e=j.getState().find((function(e){return e.id===t.id}));return Object.assign({},t,e)}))})).on(d.fail,(function(t){t.params;var e=t.error;console.error(e)})),j=Object(a.c)([]).on(m,(function(t,e){return e.result})).on(p,(function(t){return t})).on(g,(function(t,e){var n=e.id,a=e.title,r=e.image,i=e.price,o=t.some((function(t){return t.id===n}))?t.map((function(t){return t.id===n?Object.assign({},t,{amt:t.amt+1}):t})):[{id:n,title:a,image:r,price:i,amt:1}].concat(l(t));return b(o),o})).on(f,(function(t,e){var n=e.id,a=t.filter((function(t){return t.id!==n}));return h(n),a})),O=Object(a.c)(0).on(v,(function(t){return j.getState()?j.getState().reduce((function(t,e){return Number((t+parseFloat(e.price)*e.amt).toFixed(2))}),0):0})),S=Object(a.c)(1).on(y,(function(t,e){return e})),w=Object(a.d)({cartList:j,totalPrice:O});document.querySelector("#filter-available").addEventListener("click",(function(t){t.target.checked?d({url:"http://localhost:3000/goods?_page=1&_limit=15&available=true"}):d({url:"http://localhost:3000/goods?_page=1&_limit=15"})}));document.querySelector("#sort").addEventListener("click",(function(t){if(t.target.value){var e=t.target.value.split("-");d({url:"http://localhost:3000/goods?_page=1&_limit=15&_sort=".concat(e[0],"&_order=").concat(e[1])})}else d({url:"http://localhost:3000/goods?_page=1&_limit=15"})})),Object(a.e)({from:j,to:v}),Object(a.e)({from:v,to:p}),d.finally.watch((function(t){t.params;var e=t.status,n=t.result,a=t.error;if("done"===!e)i({loading:!0});else if(a&&console.log("handler rejected",a),n){i({data:x.getState()}),document.querySelector(".pagination").innerHTML=c(function(t){var e=t.total,n=t.current,a=e/15;return{pages:[{index:1},{index:n<=2?2:"..."},{index:n<=2?3:n>a-1?a-2:n},{index:n===a?a-1:"..."},{index:a}],current:n,totalCount:e,totalPages:a}}({total:3e3,current:S.getState()}));var r=document.querySelectorAll(".pagination-item"),l=function(t){y(parseInt(t.target.getAttribute("data-page"))),d({url:"http://localhost:3000/goods?_page=".concat(t.target.getAttribute("data-page"),"&_limit=15")})};r.forEach((function(t){t.addEventListener("click",l)}))}})),b.watch((function(t){i({data:x.getState()})})),h.watch((function(t){i({data:x.getState()})})),u.finally.watch((function(t){t.params;var e=t.status,n=t.result,a=t.error;"done"===!e?document.querySelector(".cart").innerHTML=s({cart:{},loading:!0}):(a&&console.log("handler rejected",a),n&&(m({result:n}),document.querySelector(".cart").innerHTML=s({cart:w.getState(),loading:!1})))})),u(),d({url:"http://localhost:3000/goods?_page=1&_limit=15"}),w.watch((function(t){document.querySelector(".cart").innerHTML=s({cart:t});var e=document.querySelectorAll(".remove-from-cart"),n=function(t){f({id:t.target.id})};e.forEach((function(t){t.addEventListener("click",n)}))}))}});
//# sourceMappingURL=app.6b972914.js.map